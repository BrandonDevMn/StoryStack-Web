<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>StoryShelf</title>

```
<!-- Progressive Web App (PWA) meta tags -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="StoryShelf">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#667eea">

<!-- Icons -->
<link rel="icon" type="image/jpeg" href="icon.jpg">
<link rel="apple-touch-icon" href="icon.jpg">
<link rel="apple-touch-icon-precomposed" href="icon.jpg">

<!-- Web App Manifest -->
<link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlN0b3J5U2hlbGYiLAogICJzaG9ydF9uYW1lIjogIlN0b3J5U2hlbGYiLAogICJkZXNjcmlwdGlvbiI6ICJSYW5kb21seSBwaWNrIHlvdXIgbmV4dCByZWFkIGZyb20geW91ciBUQlIgbGlzdCIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzY2N2VlYSIsCiAgInRoZW1lX2NvbG9yIjogIiM2NjdlZWEiLAogICJvcmllbnRhdGlvbiI6ICJwb3J0cmFpdC1wcmltYXJ5IiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiaWNvbi5qcGciLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL2pwZWciLAogICAgICAicHVycG9zZSI6ICJhbnkgbWFza2FibGUiCiAgICB9CiAgXQp9">
<style>
    /* Reset and base styles */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        color: #333;
    }

    /* Main container */
    .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    /* Header */
    .header {
        text-align: center;
        margin-bottom: 32px;
    }

    .title {
        font-size: 28px;
        font-weight: 700;
        color: #4a5568;
        margin-bottom: 8px;
    }

    .subtitle {
        font-size: 16px;
        color: #718096;
        font-weight: 400;
    }

    /* Input section */
    .input-section {
        margin-bottom: 24px;
    }

    .input-label {
        display: block;
        font-size: 16px;
        font-weight: 600;
        color: #4a5568;
        margin-bottom: 12px;
    }

    .book-textarea {
        width: 100%;
        min-height: 200px;
        padding: 16px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 16px;
        font-family: inherit;
        resize: vertical;
        transition: border-color 0.2s ease;
    }

    .book-textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .book-textarea::placeholder {
        color: #a0aec0;
    }

    /* Buttons */
    .btn {
        width: 100%;
        padding: 16px 24px;
        font-size: 18px;
        font-weight: 600;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        min-height: 56px;
        touch-action: manipulation;
    }

    .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        margin-bottom: 24px;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
    }

    .btn-secondary {
        background: #f7fafc;
        color: #4a5568;
        border: 2px solid #e2e8f0;
    }

    .btn-secondary:hover {
        background: #edf2f7;
        border-color: #cbd5e0;
    }

    .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }

    /* Results section */
    .results {
        display: none;
        animation: fadeIn 0.5s ease;
    }

    .results.show {
        display: block;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .results-header {
        text-align: center;
        margin-bottom: 24px;
    }

    .results-title {
        font-size: 22px;
        font-weight: 700;
        color: #4a5568;
        margin-bottom: 8px;
    }

    .results-subtitle {
        font-size: 14px;
        color: #718096;
    }

    /* Book picks */
    .book-pick {
        background: #f8fafc;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 16px;
        border-left: 4px solid;
    }

    .book-pick.next-read {
        border-left-color: #48bb78;
        background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%);
    }

    .book-pick.backup {
        border-left-color: #ed8936;
        background: linear-gradient(135deg, #fffaf0 0%, #fbd38d 100%);
    }

    .book-pick.alternative {
        border-left-color: #667eea;
        background: linear-gradient(135deg, #f7fafc 0%, #e2e8f0 100%);
    }

    .pick-label {
        font-size: 14px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
    }

    .next-read .pick-label { color: #2f855a; }
    .backup .pick-label { color: #c05621; }
    .alternative .pick-label { color: #4c51bf; }

    .book-title {
        font-size: 18px;
        font-weight: 600;
        color: #2d3748;
        line-height: 1.4;
        word-wrap: break-word;
    }

    /* Error message */
    .error {
        background: #fed7d7;
        color: #c53030;
        padding: 16px;
        border-radius: 12px;
        margin-bottom: 16px;
        font-weight: 500;
        text-align: center;
        display: none;
    }

    .error.show {
        display: block;
    }

    /* Responsive design */
    @media (max-width: 480px) {
        .container {
            padding: 20px;
            margin: 10px;
            border-radius: 12px;
        }

        .title {
            font-size: 24px;
        }

        .book-textarea {
            min-height: 160px;
            padding: 14px;
        }

        .btn {
            font-size: 16px;
            padding: 14px 20px;
        }
    }

    /* Loading state */
    .loading {
        display: none;
        text-align: center;
        color: #718096;
        font-style: italic;
    }

    .loading.show {
        display: block;
    }
</style>
```

</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="title">ðŸ“š StoryShelf</h1>
            <p class="subtitle">What should I read next?</p>
        </div>

```
    <!-- Input Section -->
    <div class="input-section">
        <label for="bookList" class="input-label">Your To-Be-Read List</label>
        <textarea 
            id="bookList" 
            class="book-textarea" 
            placeholder="Enter your books, one per line:
```

The Seven Husbands of Evelyn Hugo by Taylor Jenkins Reid
Project Hail Mary by Andy Weir
Klara and the Sun by Kazuo Ishiguro
The Midnight Library by Matt Haig
Circe by Madeline Millerâ€
></textarea>
</div>

```
    <!-- Pick Books Button -->
    <button id="pickBooksBtn" class="btn btn-primary">
        Pick My Next Books
    </button>

    <!-- Error Message -->
    <div id="errorMessage" class="error"></div>

    <!-- Loading State -->
    <div id="loadingMessage" class="loading">
        Selecting your perfect reads...
    </div>

    <!-- Results Section -->
    <div id="resultsSection" class="results">
        <div class="results-header">
            <h2 class="results-title">Your Reading Picks</h2>
            <p class="results-subtitle">Happy reading! ðŸ“–</p>
        </div>

        <div id="nextRead" class="book-pick next-read">
            <div class="pick-label">Next Read</div>
            <div class="book-title" id="nextReadTitle"></div>
        </div>

        <div id="backupChoice" class="book-pick backup">
            <div class="pick-label">Backup Choice</div>
            <div class="book-title" id="backupTitle"></div>
        </div>

        <div id="alternativePick" class="book-pick alternative">
            <div class="pick-label">Alternative Pick</div>
            <div class="book-title" id="alternativeTitle"></div>
        </div>

        <button id="pickAgainBtn" class="btn btn-secondary">
            Pick Again
        </button>
    </div>
</div>

<script>
    // Global variables
    let bookList = [];
    
    // DOM elements
    const bookTextarea = document.getElementById('bookList');
    const pickBooksBtn = document.getElementById('pickBooksBtn');
    const pickAgainBtn = document.getElementById('pickAgainBtn');
    const resultsSection = document.getElementById('resultsSection');
    const errorMessage = document.getElementById('errorMessage');
    const loadingMessage = document.getElementById('loadingMessage');
    const nextReadTitle = document.getElementById('nextReadTitle');
    const backupTitle = document.getElementById('backupTitle');
    const alternativeTitle = document.getElementById('alternativeTitle');

    // Process the book list from textarea
    function processBookList() {
        const rawText = bookTextarea.value.trim();
        
        if (!rawText) {
            showError("Please add some books to your TBR list!");
            return false;
        }

        // Split by newlines and filter out empty lines
        bookList = rawText
            .split('\n')
            .map(book => book.trim())
            .filter(book => book.length > 0);

        if (bookList.length < 3) {
            showError("Add at least 3 books to get recommendations!");
            return false;
        }

        hideError();
        return true;
    }

    // Select 3 random books from the list
    function selectBooks() {
        const selectedIndices = new Set();
        const picks = [];

        // Ensure we get 3 different books
        while (picks.length < 3 && picks.length < bookList.length) {
            const randomIndex = Math.floor(Math.random() * bookList.length);
            
            if (!selectedIndices.has(randomIndex)) {
                selectedIndices.add(randomIndex);
                picks.push(bookList[randomIndex]);
            }
        }

        return picks;
    }

    // Display the selected books
    function displayBookPicks(picks) {
        nextReadTitle.textContent = picks[0];
        backupTitle.textContent = picks[1];
        alternativeTitle.textContent = picks[2];

        resultsSection.classList.add('show');
    }

    // Show error message
    function showError(message) {
        errorMessage.textContent = message;
        errorMessage.classList.add('show');
    }

    // Hide error message
    function hideError() {
        errorMessage.classList.remove('show');
    }

    // Show loading state
    function showLoading() {
        loadingMessage.classList.add('show');
        pickBooksBtn.disabled = true;
    }

    // Hide loading state
    function hideLoading() {
        loadingMessage.classList.remove('show');
        pickBooksBtn.disabled = false;
    }

    // Main function to pick books
    function pickBooks() {
        hideError();
        
        if (!processBookList()) {
            return;
        }

        showLoading();

        // Add a small delay for better UX
        setTimeout(() => {
            const selectedBooks = selectBooks();
            displayBookPicks(selectedBooks);
            hideLoading();
        }, 500);
    }

    // Pick again with the same book list
    function pickAgain() {
        hideError();
        
        const selectedBooks = selectBooks();
        displayBookPicks(selectedBooks);
    }

    // Event listeners
    pickBooksBtn.addEventListener('click', pickBooks);
    pickAgainBtn.addEventListener('click', pickAgain);

    // Allow Enter key to trigger book picking (when not in textarea)
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && e.target !== bookTextarea) {
            e.preventDefault();
            if (resultsSection.classList.contains('show')) {
                pickAgain();
            } else {
                pickBooks();
            }
        }
    });

    // Auto-resize textarea on mobile
    bookTextarea.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = Math.max(this.scrollHeight, 200) + 'px';
    });
</script>
```

</body>
</html>